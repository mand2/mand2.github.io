---
title: "[AWS] RDS 생성 및 배포"
categories: aws
date: 2019-08-23 18:32:00
---

MySQL 5.7을 AWS RDS로 만들어보자.









# 1 RDS - mysql 생성

RDS dashboard 에서 중간 부분에 '데이터베이스 생성' 버튼 클릭

>MySQL 선택, 버전설정은 그대로 놔둠.
>
>템플릿: free
>
>설정부분 : DB인스턴스식별자, username, pw 설정 
>
>username 과 pw은 mysql에서 rds 연결 할 때 사용되므로 기억해야 함.

<br>

### 1-1 DB 생성 후

#1 왼쪽 사이드바에서 `데이터베이스` 클릭 

#2 생성한 DB 식별자의 이름 클릭 

#3 현재 기본적으로 **퍼블릭 엑세스 가능성**(연결&보안 탭)이 아니오로 설정되었으므로, 수정으로 들어가서 퍼블릭 엑세스 '예'로 설정

<br>

### 1-2 DB 생성 후

#1 **보안그룹**으로 들어가서 인바운드 규칙 추가:  

#1-2 MYSQL/Aurora 유형, TCP, 3306, 모든포트

잘 모르겠으면 [여기](https://stackoverflow.com/questions/37212945/aws-cant-connect-to-rds-database-from-my-machine)로 가서 순서대로 하면 됨



<br><br>

# 2 톰캣 tomcat 권한 설정

```
# cd /usr/share/tomcat8
# chgrp -R tomcat /usr/share/tomcat8
# chown -R tomcat webapps/ work/ temp/ logs/
# find conf webapps -type d -exec chmod 755 {} +
# find conf webapps -type f -exec chmod 644 {} +
# find logs temp work -type d -exec chmod 750 {} +
# find logs temp work -type f -exec chmod 640 {} +
# service tomcat8 restart
```

<br><br>

# MySQL 기존 table import 하기

먼저, aws-rds-admin 커넥션을 만들어준다.

> connection name : aws 의 이름을 정해준다. 예)aws-rds-admin
>
> connection method : standard TCP/IP
>
> host name : RDS의 엔드포인트
>
> username : RDS에서 지정한 이름
>
> pw : RDS에서 지정한 비밀번호
>
> -------test connection 하고, successful 나오면 ` ok `!!!

스키마 권한 주고 project 생성 -> table import 하기

<br><br>

# war파일로 배포하기

파일을 바로 tomcat8파일로 넣을 수 없으므로, /home/ec2-user에 업로드 한 후(필자는 fileZilla 무료버전을 이용하여 ec2-user파일에 넣어줌) 아래와 같이 함.

```
$ sudo su -
# cd /home/ec2-user   
# mv FirstWeb.war /var/lib/tomcat8/webapps/web.war    

파일이 제대로 이동했는지 디렉토리 이동해서 보면 됨.
```

**간단정리**

-cd [원하는 디렉터리 경로] : 디렉토리로 이동 (chagne directory)

-mv [옮기고자 하는 파일 혹은 전체 파일경로도 됨] [이동하고자하는 파일경로]   
		파일 이동할 때 파일명까지 변경이 됨. 

<br><br>

URL 주소창에 AWS 퍼블릭IP : [포트번호] / [war파일의 배포이름] 로 들어가면 톰캣이 구동되면서 루트 페이지로 랜딩된다.

<br><br><br><br>

<br>

### java version 1.7 으로 다운그레이드 될 때

```
# yum remove java-1.7.0-openjdk

[dependencies] 다 지워짐,,

# yum install -y java-1.8.0-openjdk-src.x86_64
# yum install -y java-1.8.0-openjdk.x86_64

[tomcat8 다시 깔면 됨,,,]
```

확인해 보니까`-src`파일만 설치하고 openjdk 파일을 미설치했다.

그래서 java 를 다 삭제하고

다시 깔아줌!!  ㅠㅠㅠ 설치할 때 잘 보고 설치하자,,

<br><br><br><br><br><br>